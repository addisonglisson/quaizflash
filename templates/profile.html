{% extends "index.html" %}
{% block meta_description %}
<meta name="description" content="Your QuaizFlash profile with all of your AI-powered flashcards, flashcard sets, and personalized study plans. Quiz and view your flashcards.">
{% endblock %}
{% block content %}
<div class="container">
  <div class="profile-header">
    <div class="profile-info">
      <h2>{{ current_user.username }}'s Profile</h2>
      <p>Email: {{ current_user.email }}</p>
      <!-- Add more user info here -->
    </div>
    <div class="profile-stats">
      <div class="stat-box">
        <span class="stat-number" id="stat-flashcards">0</span>
        <div class="stat-label">Flashcards</div>
      </div>
      <div class="stat-box">
        <span class="stat-number" id="stat-sets">0</span>
        <div class="stat-label">Sets</div>
      </div>
      <div class="stat-box">
        <span class="stat-number" id="stat-pods">0</span>
        <div class="stat-label">Pods</div>
      </div>
    </div>
  </div>

  <h3 class="section-title">My Flashcards</h3>
  <div class="scrollable-container">
    <div class="row">
      {% for flashcard in flashcards %}
        <div class="col-md-4 mb-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">{{ flashcard.question }}</h5>
              <p class="card-text">{{ flashcard.answer }}</p>
              <div class="action-buttons">
                <a href="{{ url_for('edit_flashcard', flashcard_id=flashcard.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
                <a href="{{ url_for('select_set', flashcard_id=flashcard.id) }}" class="btn btn-sm btn-outline-primary">Add to Set</a>
                <form method="POST" action="{{ url_for('delete_flashcard', flashcard_id=flashcard.id) }}" class="join-pod-form">
                  <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this flashcard?');">Delete</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
<!-- Main Page -->
<a href="{{ url_for('new_flashcard') }}" class="btn btn-primary">Create Flashcard</a>



  
  <div class="container">
    <div class="row">
      <!-- Flashcard Sets Section -->
      {% if flashcard_sets %}
        <div class="col-md-12">
          <h3 class="section-title">My Flashcard Sets</h3>
          <div class="row">
            {% for flashcard_set in flashcard_sets %}
              <div class="col-md-4 mb-3">
                <div class="card">
                  <div class="card-body">
                    <h5 class="card-title">{{ flashcard_set.title }}</h5>
                    <p class="card-text">{{ flashcard_set.description }}</p>
                    <a href="{{ url_for('flashcard_set', set_id=flashcard_set.id) }}" class="btn btn-sm btn-outline-primary">View Set</a>
                    <a href="{{ url_for('new_flashcard', set_id=flashcard_set.id) }}" class="btn btn-sm btn-outline-primary">Add New Flashcard</a>
                    <a href="{{ url_for('quiz_settings', set_id=flashcard_set.id) }}" class="btn btn-sm btn-outline-primary">Quiz Me</a>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% else %}
        <p class="text-center">No flashcard sets found.</p>
      {% endif %}
    </div>
  </div>

<a href="{{ url_for('create_flashcard_set') }}" class="btn btn-primary">Create Flashcard Set</a>

      <!-- Study Pods Section -->
      {% if study_pods %}
        <div class="col-md-12">
          <h3 class="section-title">My Study Pods</h3>
          <div class="row">
            {% for pod in study_pods %}
              <div class="col-md-4 mb-3">
                <div class="card">
                  <div class="card-body">
                    <h5 class="card-title">{{ pod.name }}</h5>
                    <p class="card-text">{{ pod.description }}</p>
                    <a href="{{ url_for('view_pod', pod_id=pod.id) }}" class="btn btn-sm btn-outline-primary">View Pod</a>
                    <form method="POST" action="{{ url_for('leave_pod', pod_id=pod.id) }}" class="join-pod-form">
                      <button type="submit" class="btn btn-sm btn-outline-danger">Leave Pod</button>
                  </form>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% else %}
        <p class="text-center">You are not a part of any Study Pods yet.</p>
      {% endif %}

<a href="{{ url_for('create_pod') }}" class="btn btn-primary">Create Study Pod</a>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Define the values as JavaScript variables
      var totalFlashcards = {{ total_flashcards | tojson }};
      var totalSets = {{ total_sets | tojson }};
      var totalPods = {{ total_pods | tojson }};

      // Rest of your script...
      animateValue("stat-flashcards", 0, totalFlashcards, 1500);
      animateValue("stat-sets", 0, totalSets, 1500);
      animateValue("stat-pods", 0, totalPods, 1500);


      function animateValue(id, start, end, duration) {
    if (end < 0) end = 0;  // Ensure end value is not less than 0
    let range = Math.abs(end - start); // Calculate the absolute value of the range
    let current = start;
    let increment = end > start ? 1 : -1;
    let stepTime = Math.abs(Math.floor(duration / range));
    let obj = document.getElementById(id);
    let timer = setInterval(function() {
        current += increment;
        if ((increment > 0 && current > end) || (increment < 0 && current < end)) {
            current = end; // Ensure current does not exceed end
        }
        obj.textContent = current;
        if (current === end) {
            clearInterval(timer);
        }
    }, stepTime);
}

    });
  </script>
{% endblock %}
